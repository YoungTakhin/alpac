---
title: 设计模式6 抽象工厂模式
color: '#EBF8FF'
tags: 设计模式
categories: 设计模式
abbrlink: 18608
date: 2019-12-03 10:21:55
---

# 设计模式6 抽象工厂模式

抽象工厂模式(Abstract Factory Pattern)，也称为Kit模式，属于对象创建型模式。

## 抽象工厂模式定义

- 抽象工厂模式：

  提供一个创建一系列相关或相互依赖对象的接口，且访问类无须指定所要产品的具体类就能得到同族的不同等级的产品的模式结构。

  抽象工厂模式是工厂方法模式的升级版本，工厂方法模式只生产一个等级的产品，而抽象工厂模式可生产多个等级的产品。

- 抽象工厂模式特点：
  
  “开闭原则”的倾斜性：**“开闭原则”要求系统对扩展开放，对修改封闭，通过扩展达到增强其功能的目的。**对于涉及到多个产品族与多个产品等级结构的系统，其功能增强包括两方面：
  
  - 增加产品族：对于增加新的产品族，工厂方法模式很好的支持了“开闭原则”，对于新增加的产品族，只需要对应增加一个新的具体工厂即可，对已有代码无须做任何修改。
  - 增加新的产品等级结构：对于增加新的产品等级结构，需要修改所有的工厂角色，包括抽象工厂类，在所有的工厂类中都需要增加生产新产品的方法，不能很好地支持“开闭原则”。
            
  抽象工厂模式的这种性质称为**“开闭原则”的倾斜性**，抽象工厂模式以一种倾斜的方式支持增加新的产品，它为新产品族的增加提供方便，但不能为新的产品等级结构的增加提供这样的方便。

- 抽象工厂模式优缺点：

  优点：
  - 可以在类的内部对产品族中相关联的多等级产品共同管理，而不必专门引入多个新的类来进行管理。
  - 当增加一个新的产品族时不需要修改原代码，满足开闭原则。
  
  缺点：
  - 当产品族中需要增加一个新的产品时，所有的工厂类都需要进行修改。
  
## 抽象工厂模式结构


- 抽象工厂模式主要包括以下主要角色：
  - 抽象工厂（Abstract Factory）：提供了创建产品的接口，它包含多个创建产品的方法 newProduct()，可以创建多个不同等级的产品。
  - 具体工厂（Concrete Factory）：主要是实现抽象工厂中的多个抽象方法，完成具体产品的创建。
  - 抽象产品（Product）：定义了产品的规范，描述了产品的主要特性和功能，抽象工厂模式有多个抽象产品。
  - 具体产品（ConcreteProduct）：实现了抽象产品角色所定义的接口，由具体工厂来创建，它同具体工厂之间是多对一的关系。
- 抽象工厂模式类图：

  ![抽象工厂模式](https://s2.ax1x.com/2019/12/03/QK2DAA.png)

## 抽象工厂模式实现方法

抽象工厂模式的结构同工厂方法模式的结构相似，不同的是其产品的种类不止一个，所以创建产品的方法也不止一个。

下面只给出抽象工厂和具体工厂的代码：

- 抽象工厂类

  抽象工厂提供了不同产品的生成方法：
  
  ```java 
  interface AbstractFactory {
      public ProductA newProductA();
      public ProductB newProductB();
  }
  ```
  
- 具体工厂类

  具体工厂实现了不同产品的生成方法：

  ```java 
  class ConcreteFactory1 implements AbstractFactory {
      public ProductA newProductA() {
          System.out.println("具体工厂1生成-->具体产品A1...");
          return new ConcreteProductA1();
      }
  
      public ProductB newProductB() {
          System.out.println("具体工厂1生成-->具体产品B1...");
          return new ConcreteProductB1();
      }
  }
  
  class ConcreteFactory2 implements AbstractFactory {
      public ProductA newProductA() {
          System.out.println("具体工厂2生成-->具体产品A2...");
          return new ConcreteProductA2();
      }
  
      public ProductB newProductB() {
          System.out.println("具体工厂2生成-->具体产品B2...");
          return new ConcreteProductB2();
      }
  }
  ```

## 抽象工厂模式扩展

- 当抽象工厂模式中每一个具体工厂类只创建一个产品对象，也就是只存在一个产品等级结构时，抽象工厂模式退化成**工厂方法模式**。
- 当工厂方法模式中抽象工厂与具体工厂合并，提供一个统一的工厂来创建产品对象，并将创建对象的工厂方法设计为静态方法时，工厂方法模式退化成**简单工厂模式**。
